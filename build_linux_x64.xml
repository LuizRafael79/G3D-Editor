<?xml version="1.0" encoding="UTF-8"?>
<project name="G3DEditor Linux x64" default="dist-targz" basedir=".">
	<property name="main" location="g3deditor.G3DEditor" />
	<property name="src" location="src" />
	<property name="dist" location="dist" />
	<property name="lib" location="lib_linux_x64" />
	<property name="data" location="data" />
	<property name="build" location="build/linux_x64" />
	<property name="build.classes" location="${build}/classes" />
	<property name="build.geo" location="${build}/g3deditor" />
	<property name="build.geo.lib" location="${build.geo}/lib" />
	<property name="build.geo.data" location="${build.geo}/data" />
	
	<path id="classpath">
		<fileset dir="${lib}">
			<include name="gluegen-rt.jar" />
			<include name="jogl-all.jar" />
		        <include name="jogl-all-natives-linux-amd64.jar" />
			<include name="gluegen-rt-natives-linux-amd64.jar" />
		</fileset>
	</path>

	<target name="clean">
		<delete dir="${build}" />
	</target>

	<target name="init" depends="clean">
		<mkdir dir="${build}" />
		<mkdir dir="${build.classes}" />
		<mkdir dir="${build.geo}" />
		<mkdir dir="${build.geo.lib}" />
		<mkdir dir="${build.geo.data}" />
	</target>

	<target name="compile" depends="init">
		<javac destdir="${build.classes}" optimize="on" debug="on" source="25" target="25" nowarn="off">
			<src path="${src}" />
			<classpath refid="classpath" />
		</javac>
	</target>

	<target name="jar" depends="compile">
		<jar destfile="${build.geo}/G3DEditor.jar">
			<fileset dir="${build.classes}" />
			<manifest>
				<attribute name="Main-Class" value="${main}" />
				<attribute name="Class-Path" value="." />
			</manifest>
		</jar>
	</target>

	<target name="dist" depends="jar">
		<copy todir="${build.geo}">
			<fileset dir="${dist}" excludes="G3DEditor.bat" />
		</copy>
		<copy todir="${build.geo.lib}">
			<fileset dir="${lib}" />
		</copy>
		<copy todir="${build.geo.data}">
			<fileset dir="${data}" />
		</copy>
	</target>

	<target name="dist-targz" depends="dist">
	    <tstamp>
	        <format property="TODAY" pattern="yyyyMMdd" />
	    </tstamp>
	    <delete includeemptydirs="true">
	        <fileset dir="${build}" includes="G3DEditor_linux_x64_*.tar.gz"/>
	    </delete>
	    <tar destfile="${build}/G3DEditor_linux_x64_${TODAY}.tar">
	        <tarfileset dir="${build.geo}" />
            <exclude name="G3DEditor.bat"/>
	    </tar>
	    <gzip src="${build}/G3DEditor_linux_x64_${TODAY}.tar"
	          destfile="${build}/G3DEditor_linux_x64_${TODAY}.tar.gz"/>
	</target>

</project>
